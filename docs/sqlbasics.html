<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R, Databases &amp; SQL</title>
  <meta name="description" content="Introduction to databases and SQL.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R, Databases &amp; SQL" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introduction to databases and SQL." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R, Databases &amp; SQL" />
  
  <meta name="twitter:description" content="Introduction to databases and SQL." />
  

<meta name="author" content="Aravind Hebbali">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="dbplyr.html">
<link rel="next" href="sql2.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/rsquaredacademy-education/rdbsql/">R, Databases & SQL</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure-of-the-book"><i class="fa fa-check"></i>Structure of the book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information"><i class="fa fa-check"></i>Software information</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="dbi.html"><a href="dbi.html"><i class="fa fa-check"></i><b>2</b> DBI</a><ul>
<li class="chapter" data-level="2.1" data-path="dbi.html"><a href="dbi.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="dbi.html"><a href="dbi.html#libraries-code-data"><i class="fa fa-check"></i><b>2.2</b> Libraries, Code &amp; Data</a></li>
<li class="chapter" data-level="2.3" data-path="dbi.html"><a href="dbi.html#connection"><i class="fa fa-check"></i><b>2.3</b> Connection</a><ul>
<li class="chapter" data-level="2.3.1" data-path="dbi.html"><a href="dbi.html#connection-summary"><i class="fa fa-check"></i><b>2.3.1</b> Connection Summary</a></li>
<li class="chapter" data-level="2.3.2" data-path="dbi.html"><a href="dbi.html#list-tables"><i class="fa fa-check"></i><b>2.3.2</b> List Tables</a></li>
<li class="chapter" data-level="2.3.3" data-path="dbi.html"><a href="dbi.html#list-fields"><i class="fa fa-check"></i><b>2.3.3</b> List Fields</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="dbi.html"><a href="dbi.html#querying-data"><i class="fa fa-check"></i><b>2.4</b> Querying Data</a><ul>
<li class="chapter" data-level="2.4.1" data-path="dbi.html"><a href="dbi.html#entire-table"><i class="fa fa-check"></i><b>2.4.1</b> Entire Table</a></li>
<li class="chapter" data-level="2.4.2" data-path="dbi.html"><a href="dbi.html#few-rows"><i class="fa fa-check"></i><b>2.4.2</b> Few Rows</a></li>
<li class="chapter" data-level="2.4.3" data-path="dbi.html"><a href="dbi.html#read-data-in-batches"><i class="fa fa-check"></i><b>2.4.3</b> Read Data in Batches</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="dbi.html"><a href="dbi.html#query"><i class="fa fa-check"></i><b>2.5</b> Query</a><ul>
<li class="chapter" data-level="2.5.1" data-path="dbi.html"><a href="dbi.html#query-status"><i class="fa fa-check"></i><b>2.5.1</b> Query Status</a></li>
<li class="chapter" data-level="2.5.2" data-path="dbi.html"><a href="dbi.html#query-info"><i class="fa fa-check"></i><b>2.5.2</b> Query Info</a></li>
<li class="chapter" data-level="2.5.3" data-path="dbi.html"><a href="dbi.html#latest-query"><i class="fa fa-check"></i><b>2.5.3</b> Latest Query</a></li>
<li class="chapter" data-level="2.5.4" data-path="dbi.html"><a href="dbi.html#rows-fetched"><i class="fa fa-check"></i><b>2.5.4</b> Rows Fetched</a></li>
<li class="chapter" data-level="2.5.5" data-path="dbi.html"><a href="dbi.html#rows-affected"><i class="fa fa-check"></i><b>2.5.5</b> Rows Affected</a></li>
<li class="chapter" data-level="2.5.6" data-path="dbi.html"><a href="dbi.html#column-info"><i class="fa fa-check"></i><b>2.5.6</b> Column Info</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="dbi.html"><a href="dbi.html#create-table"><i class="fa fa-check"></i><b>2.6</b> Create Table</a></li>
<li class="chapter" data-level="2.7" data-path="dbi.html"><a href="dbi.html#append-data"><i class="fa fa-check"></i><b>2.7</b> Append Data</a></li>
<li class="chapter" data-level="2.8" data-path="dbi.html"><a href="dbi.html#insert-rows"><i class="fa fa-check"></i><b>2.8</b> Insert Rows</a></li>
<li class="chapter" data-level="2.9" data-path="dbi.html"><a href="dbi.html#remove-table"><i class="fa fa-check"></i><b>2.9</b> Remove Table</a></li>
<li class="chapter" data-level="2.10" data-path="dbi.html"><a href="dbi.html#sqlite-data-type"><i class="fa fa-check"></i><b>2.10</b> SQLite Data Type</a></li>
<li class="chapter" data-level="2.11" data-path="dbi.html"><a href="dbi.html#close-connection"><i class="fa fa-check"></i><b>2.11</b> Close Connection</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dbplyr.html"><a href="dbplyr.html"><i class="fa fa-check"></i><b>3</b> dbplyr</a><ul>
<li class="chapter" data-level="3.1" data-path="dbplyr.html"><a href="dbplyr.html#introduction-3"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="dbplyr.html"><a href="dbplyr.html#libraries-code-data-1"><i class="fa fa-check"></i><b>3.2</b> Libraries, Code &amp; Data</a></li>
<li class="chapter" data-level="3.3" data-path="dbplyr.html"><a href="dbplyr.html#connect-to-database"><i class="fa fa-check"></i><b>3.3</b> Connect to Database</a></li>
<li class="chapter" data-level="3.4" data-path="dbplyr.html"><a href="dbplyr.html#reference-data"><i class="fa fa-check"></i><b>3.4</b> Reference Data</a></li>
<li class="chapter" data-level="3.5" data-path="dbplyr.html"><a href="dbplyr.html#query-data"><i class="fa fa-check"></i><b>3.5</b> Query Data</a></li>
<li class="chapter" data-level="3.6" data-path="dbplyr.html"><a href="dbplyr.html#show-query"><i class="fa fa-check"></i><b>3.6</b> Show Query</a></li>
<li class="chapter" data-level="3.7" data-path="dbplyr.html"><a href="dbplyr.html#collect-data"><i class="fa fa-check"></i><b>3.7</b> Collect Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sqlbasics.html"><a href="sqlbasics.html"><i class="fa fa-check"></i><b>4</b> SQL Basics</a><ul>
<li class="chapter" data-level="4.1" data-path="sqlbasics.html"><a href="sqlbasics.html#introduction-4"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="sqlbasics.html"><a href="sqlbasics.html#libraries-code-data-2"><i class="fa fa-check"></i><b>4.2</b> Libraries, Code &amp; Data</a></li>
<li class="chapter" data-level="4.3" data-path="sqlbasics.html"><a href="sqlbasics.html#set-up"><i class="fa fa-check"></i><b>4.3</b> Set Up</a></li>
<li class="chapter" data-level="4.4" data-path="sqlbasics.html"><a href="sqlbasics.html#select-columns"><i class="fa fa-check"></i><b>4.4</b> Select Columns</a><ul>
<li class="chapter" data-level="4.4.1" data-path="sqlbasics.html"><a href="sqlbasics.html#syntax"><i class="fa fa-check"></i><b>4.4.1</b> Syntax</a></li>
<li class="chapter" data-level="4.4.2" data-path="sqlbasics.html"><a href="sqlbasics.html#select-single-column"><i class="fa fa-check"></i><b>4.4.2</b> Select Single Column</a></li>
<li class="chapter" data-level="4.4.3" data-path="sqlbasics.html"><a href="sqlbasics.html#select-multiple-columns"><i class="fa fa-check"></i><b>4.4.3</b> Select Multiple Columns</a></li>
<li class="chapter" data-level="4.4.4" data-path="sqlbasics.html"><a href="sqlbasics.html#select-all-columns"><i class="fa fa-check"></i><b>4.4.4</b> Select All Columns</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sqlbasics.html"><a href="sqlbasics.html#limit"><i class="fa fa-check"></i><b>4.5</b> Limit</a></li>
<li class="chapter" data-level="4.6" data-path="sqlbasics.html"><a href="sqlbasics.html#distinct"><i class="fa fa-check"></i><b>4.6</b> Distinct</a></li>
<li class="chapter" data-level="4.7" data-path="sqlbasics.html"><a href="sqlbasics.html#filter"><i class="fa fa-check"></i><b>4.7</b> Filter</a></li>
<li class="chapter" data-level="4.8" data-path="sqlbasics.html"><a href="sqlbasics.html#and-or-not"><i class="fa fa-check"></i><b>4.8</b> And, Or &amp; Not</a></li>
<li class="chapter" data-level="4.9" data-path="sqlbasics.html"><a href="sqlbasics.html#between"><i class="fa fa-check"></i><b>4.9</b> BETWEEN</a></li>
<li class="chapter" data-level="4.10" data-path="sqlbasics.html"><a href="sqlbasics.html#in"><i class="fa fa-check"></i><b>4.10</b> IN</a></li>
<li class="chapter" data-level="4.11" data-path="sqlbasics.html"><a href="sqlbasics.html#is-null"><i class="fa fa-check"></i><b>4.11</b> IS NULL</a></li>
<li class="chapter" data-level="4.12" data-path="sqlbasics.html"><a href="sqlbasics.html#like"><i class="fa fa-check"></i><b>4.12</b> LIKE</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sql2.html"><a href="sql2.html"><i class="fa fa-check"></i><b>5</b> SQL Advanced</a><ul>
<li class="chapter" data-level="5.1" data-path="sql2.html"><a href="sql2.html#introduction-5"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="sql2.html"><a href="sql2.html#libraries-code-data-3"><i class="fa fa-check"></i><b>5.2</b> Libraries, Code &amp; Data</a></li>
<li class="chapter" data-level="5.3" data-path="sql2.html"><a href="sql2.html#set-up-1"><i class="fa fa-check"></i><b>5.3</b> Set Up</a></li>
<li class="chapter" data-level="5.4" data-path="sql2.html"><a href="sql2.html#aggregate"><i class="fa fa-check"></i><b>5.4</b> Aggregate</a></li>
<li class="chapter" data-level="5.5" data-path="sql2.html"><a href="sql2.html#alias"><i class="fa fa-check"></i><b>5.5</b> Alias</a></li>
<li class="chapter" data-level="5.6" data-path="sql2.html"><a href="sql2.html#order-by"><i class="fa fa-check"></i><b>5.6</b> Order By</a></li>
<li class="chapter" data-level="5.7" data-path="sql2.html"><a href="sql2.html#group-by"><i class="fa fa-check"></i><b>5.7</b> Group By</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R, Databases &amp; SQL</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sqlbasics" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> SQL Basics</h1>
<div id="introduction-4" class="section level2">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<p>In this chapter, we will learn to:</p>
<ul>
<li>select
<ul>
<li>single column</li>
<li>multiple columns</li>
<li>distinct values in a column</li>
</ul></li>
<li>limit the number of records returned</li>
<li>handle NULL values</li>
<li>and filter columns using the following operators
<ul>
<li>WHERE</li>
<li>AND, or &amp; NOT</li>
<li>BETWEEN</li>
<li>IN</li>
<li>LIKE</li>
</ul></li>
</ul>
</div>
<div id="libraries-code-data-2" class="section level2">
<h2><span class="header-section-number">4.2</span> Libraries, Code &amp; Data</h2>
<p>We will use the following libraries:</p>
<ul>
<li><a href="http://readr.tidyverse.org/">DBI</a></li>
<li><a href="https://rstats-db.github.io/RSQLite/">RSQLite</a></li>
<li><a href="http://dbplyr.tidyverse.org/">dbplyr</a></li>
</ul>
<p>All the data sets used in this chapter can be found <a href="https://github.com/rsquaredacademy/datasets">here</a> and code can be downloaded from <a href="https://gist.github.com/rsquaredacademy/f44774d9c6e115c08d5e2e693380a00f">here</a>.</p>
</div>
<div id="set-up" class="section level2">
<h2><span class="header-section-number">4.3</span> Set Up</h2>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">ecom &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/rsquaredacademy/datasets/master/web.csv&#39;</span>)</a>
<a class="sourceLine" id="cb70-2" data-line-number="2">con &lt;-<span class="st"> </span>DBI<span class="op">::</span><span class="kw">dbConnect</span>(RSQLite<span class="op">::</span><span class="kw">SQLite</span>(), <span class="st">&quot;:memory:&quot;</span>)</a>
<a class="sourceLine" id="cb70-3" data-line-number="3"><span class="kw">copy_to</span>(con, ecom)</a></code></pre></div>
</div>
<div id="select-columns" class="section level2">
<h2><span class="header-section-number">4.4</span> Select Columns</h2>
<p>The SQL SELECT statement is used to fetch the data from a database table.</p>
<div id="syntax" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Syntax</h3>
<p>Below is the basic syntax of the SELECT statement.</p>
<p><code>SELECT column1, column2, columnN FROM table_name;</code></p>
<p>Here, column1, column2… are the fields of a table whose values you want to fetch.
If you want to fetch all the fields, use the following syntax.</p>
<p><code>SELECT * FROM table_name;</code></p>
</div>
<div id="select-single-column" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Select Single Column</h3>
<p>Let us begin by selecting the <code>device</code> field from the <code>ecom</code> table.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT device FROM ecom&quot;</span>)</a></code></pre></div>
<pre><code>##      device
## 1    laptop
## 2    tablet
## 3    laptop
## 4    tablet
## 5    mobile
## 6    laptop
## 7    mobile
## 8    mobile
## 9    mobile
## 10   mobile
## 11   laptop
## 12   tablet
## 13   mobile
## 14   tablet
## 15   mobile
## 16   laptop
## 17   tablet
## 18   tablet
## 19   tablet
## 20   tablet
## 21   laptop
## 22   mobile
## 23   mobile
## 24   laptop
## 25   laptop
## 26   laptop
## 27   tablet
## 28   laptop
## 29   mobile
## 30   mobile
## 31   tablet
## 32   mobile
## 33   laptop
## 34   tablet
## 35   mobile
## 36   mobile
## 37   laptop
## 38   mobile
## 39   mobile
## 40   mobile
## 41   mobile
## 42   mobile
## 43   laptop
## 44   tablet
## 45   laptop
## 46   tablet
## 47   mobile
## 48   laptop
## 49   mobile
## 50   tablet
##  [ reached getOption(&quot;max.print&quot;) -- omitted 950 rows ]</code></pre>
</div>
<div id="select-multiple-columns" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Select Multiple Columns</h3>
<p>Select the following fields from the <code>ecom</code> table:</p>
<ul>
<li><code>referrer</code></li>
<li><code>device</code></li>
<li><code>purchase</code></li>
</ul>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT referrer, device, purchase  FROM ecom&quot;</span>)</a></code></pre></div>
<pre><code>##      referrer device purchase
## 1      google laptop        0
## 2       yahoo tablet        0
## 3      direct laptop        0
## 4        bing tablet        1
## 5       yahoo mobile        0
## 6       yahoo laptop        0
## 7       yahoo mobile        0
## 8      direct mobile        0
## 9        bing mobile        0
## 10     google mobile        0
## 11     direct laptop        0
## 12     direct tablet        0
## 13     direct mobile        1
## 14      yahoo tablet        0
## 15      yahoo mobile        0
## 16       bing laptop        0
##  [ reached getOption(&quot;max.print&quot;) -- omitted 984 rows ]</code></pre>
</div>
<div id="select-all-columns" class="section level3">
<h3><span class="header-section-number">4.4.4</span> Select All Columns</h3>
<p>Select all the fields from the <code>ecom</code> table.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * FROM ecom&quot;</span>)</a></code></pre></div>
<pre><code>##        id referrer device bouncers n_visit n_pages duration
## 1       1   google laptop        1      10       1      693
## 2       2    yahoo tablet        1       9       1      459
## 3       3   direct laptop        1       0       1      996
## 4       4     bing tablet        0       3      18      468
##                               country purchase order_items order_value
## 1                      Czech Republic        0           0           0
## 2                               Yemen        0           0           0
## 3                              Brazil        0           0           0
## 4                               China        1           6         434
##  [ reached getOption(&quot;max.print&quot;) -- omitted 996 rows ]</code></pre>
</div>
</div>
<div id="limit" class="section level2">
<h2><span class="header-section-number">4.5</span> Limit</h2>
<p>If you have a large table with thousands of rows, returning all the records
will take time. Use LIMIT to specify the number of records to return.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * FROM ecom limit 10&quot;</span>)</a></code></pre></div>
<pre><code>##    id referrer device bouncers n_visit n_pages duration        country
## 1   1   google laptop        1      10       1      693 Czech Republic
## 2   2    yahoo tablet        1       9       1      459          Yemen
## 3   3   direct laptop        1       0       1      996         Brazil
## 4   4     bing tablet        0       3      18      468          China
##    purchase order_items order_value
## 1         0           0           0
## 2         0           0           0
## 3         0           0           0
## 4         1           6         434
##  [ reached getOption(&quot;max.print&quot;) -- omitted 6 rows ]</code></pre>
</div>
<div id="distinct" class="section level2">
<h2><span class="header-section-number">4.6</span> Distinct</h2>
<p>A column in a table may often contain many duplicate values; and we might be interested only in the
distinct/unique values. In such cases, we can use the SELECT DISTINCT statement to return only distinct values.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT distinct referrer FROM ecom&quot;</span>)</a></code></pre></div>
<pre><code>##   referrer
## 1   google
## 2    yahoo
## 3   direct
## 4     bing
## 5   social</code></pre>
</div>
<div id="filter" class="section level2">
<h2><span class="header-section-number">4.7</span> Filter</h2>
<p>Now that we know how to select columns, let us focus on filtering data. In SQL, the WHERE keyword is used to extract only those records that fulfill a specified condition. Data filter based on both text and numeric values in a table. Below are a few comparison operators we can use:</p>
<ul>
<li><code>=</code> equal</li>
<li><code>&lt;&gt;</code> not equal</li>
<li><code>&lt;</code> less than</li>
<li><code>&gt;</code> greater than</li>
<li><code>&lt;=</code> less than or equal to</li>
<li><code>&gt;=</code> greater than or equal to</li>
</ul>
<p>The following SQL statement filters all rows from the <code>ecom</code> table where the <code>duration</code> field
is greater than 300.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * </span></a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="st">                 FROM ecom </span></a>
<a class="sourceLine" id="cb81-3" data-line-number="3"><span class="st">                 WHERE duration &gt; 300&quot;</span>)</a></code></pre></div>
<pre><code>##      id referrer device bouncers n_visit n_pages duration
## 1     1   google laptop        1      10       1      693
## 2     2    yahoo tablet        1       9       1      459
## 3     3   direct laptop        1       0       1      996
## 4     4     bing tablet        0       3      18      468
##                              country purchase order_items order_value
## 1                     Czech Republic        0           0           0
## 2                              Yemen        0           0           0
## 3                             Brazil        0           0           0
## 4                              China        1           6         434
##  [ reached getOption(&quot;max.print&quot;) -- omitted 472 rows ]</code></pre>
<p>Let us filter data based on a text value. In the following example, we filter all rows
from the <code>ecom</code> table where the <code>device</code> used is <code>mobile</code>.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * </span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2"><span class="st">                 FROM ecom </span></a>
<a class="sourceLine" id="cb83-3" data-line-number="3"><span class="st">                 WHERE device == &#39;mobile&#39;&quot;</span>)</a></code></pre></div>
<pre><code>##       id referrer device bouncers n_visit n_pages duration
## 1      5    yahoo mobile        1       9       1      955
## 2      7    yahoo mobile        1      10       1       75
## 3      8   direct mobile        1      10       1      908
## 4      9     bing mobile        0       3      19      209
##                   country purchase order_items order_value
## 1                  Poland        0           0           0
## 2              Bangladesh        0           0           0
## 3               Indonesia        0           0           0
## 4             Netherlands        0           0           0
##  [ reached getOption(&quot;max.print&quot;) -- omitted 340 rows ]</code></pre>
</div>
<div id="and-or-not" class="section level2">
<h2><span class="header-section-number">4.8</span> And, Or &amp; Not</h2>
<p>The WHERE clause can be combined with other operators such as</p>
<ul>
<li>AND - displays a record if all the conditions separated by AND is TRUE</li>
<li>OR - displays a record if any of the conditions separated by OR is TRUE</li>
<li>NOT - displays a record if the condition(s) is NOT TRUE</li>
</ul>
<p>to filter data based on more than one condition or to create more complex conditions.</p>
<p>In the following example, we filter all the rows from the <code>ecom</code> table where
<code>n_visit</code> (visit count) is greater than 3 and <code>duration</code> (time spent on the site)
is greater than 100. We use AND to create multiple conditions.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * </span></a>
<a class="sourceLine" id="cb85-2" data-line-number="2"><span class="st">                 FROM ecom </span></a>
<a class="sourceLine" id="cb85-3" data-line-number="3"><span class="st">                 WHERE n_visit &gt; 3 AND duration &gt; 100&quot;</span>)</a></code></pre></div>
<pre><code>##       id referrer device bouncers n_visit n_pages duration
## 1      1   google laptop        1      10       1      693
## 2      2    yahoo tablet        1       9       1      459
## 3      5    yahoo mobile        1       9       1      955
## 4      6    yahoo laptop        0       5       5      135
##                              country purchase order_items order_value
## 1                     Czech Republic        0           0           0
## 2                              Yemen        0           0           0
## 3                             Poland        0           0           0
## 4                       South Africa        0           0           0
##  [ reached getOption(&quot;max.print&quot;) -- omitted 509 rows ]</code></pre>
<p>In the next example, we will use both AND &amp; OR. Our goal is to filter all
rows from the <code>ecom</code> table that follow the below conditions:</p>
<ul>
<li><code>n_visit</code> (visit count) is either equal to 3 or 5</li>
<li><code>device</code> used to visit the website is either <code>mobile</code> or <code>tablet</code></li>
</ul>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * </span></a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="st">                 FROM ecom WHERE (n_visit == 5 OR n_visit == 3)  </span></a>
<a class="sourceLine" id="cb87-3" data-line-number="3"><span class="st">                 AND (device = &#39;mobile&#39; OR device = &#39;tablet&#39;)&quot;</span>)</a></code></pre></div>
<pre><code>##      id referrer device bouncers n_visit n_pages duration
## 1     4     bing tablet        0       3      18      468
## 2     9     bing mobile        0       3      19      209
## 3    14    yahoo tablet        0       5       8       80
## 4    17     bing tablet        0       5      16      368
##                   country purchase order_items order_value
## 1                   China        1           6         434
## 2             Netherlands        0           0           0
## 3             Philippines        0           2         362
## 4                    Peru        1           6        1049
##  [ reached getOption(&quot;max.print&quot;) -- omitted 130 rows ]</code></pre>
</div>
<div id="between" class="section level2">
<h2><span class="header-section-number">4.9</span> BETWEEN</h2>
<p>The BETWEEN operator selects values within a given range and is inclusive: begin and end values are included. The values can be numbers, text, or dates. In the following example, we filter rows from
the <code>ecom</code> table where the visit count is between 1 and 3, and the <code>device</code> used to visit the website is
<code>mobile</code>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * </span></a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="st">                 FROM ecom</span></a>
<a class="sourceLine" id="cb89-3" data-line-number="3"><span class="st">                 WHERE n_visit BETWEEN 1 AND 3 AND device = &#39;mobile&#39;&quot;</span>)</a></code></pre></div>
<pre><code>##     id referrer device bouncers n_visit n_pages duration
## 1    9     bing mobile        0       3      19      209
## 2   32   direct mobile        1       2       1      501
## 3   36     bing mobile        0       1       1       25
## 4   38    yahoo mobile        1       3       1      700
##                  country purchase order_items order_value
## 1            Netherlands        0           0           0
## 2            El Salvador        0           0           0
## 3                Ireland        0          10        1885
## 4                 Canada        0           0           0
##  [ reached getOption(&quot;max.print&quot;) -- omitted 86 rows ]</code></pre>
</div>
<div id="in" class="section level2">
<h2><span class="header-section-number">4.10</span> IN</h2>
<p>The IN operator allows us to specify multiple values in a WHERE clause. It is a shorthand
for multiple OR conditions. In the below example, we filter rows from the <code>ecom</code> table where
the visit count is either 2 or 4 or 6 or 8 or 10. Instead of using multiple OR conditions,
we use the IN operator.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * </span></a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="st">                 FROM ecom </span></a>
<a class="sourceLine" id="cb91-3" data-line-number="3"><span class="st">                 WHERE n_visit IN (2, 4, 6, 8, 10)&quot;</span>)</a></code></pre></div>
<pre><code>##      id referrer device bouncers n_visit n_pages duration
## 1     1   google laptop        1      10       1      693
## 2     7    yahoo mobile        1      10       1       75
## 3     8   direct mobile        1      10       1      908
## 4    10   google mobile        1       6       1      208
##                              country purchase order_items order_value
## 1                     Czech Republic        0           0           0
## 2                         Bangladesh        0           0           0
## 3                          Indonesia        0           0           0
## 4                     Czech Republic        0           0           0
##  [ reached getOption(&quot;max.print&quot;) -- omitted 443 rows ]</code></pre>
</div>
<div id="is-null" class="section level2">
<h2><span class="header-section-number">4.11</span> IS NULL</h2>
<p>A field with a NULL value is a field with no value. If a field in a table is optional, it is possible to insert a new record or update a record without adding a value to this field. Then, the field will be saved with a NULL value. In the next example, we filter all rows from the <code>ecom</code> table where the <code>device</code> column
has NULL values.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * </span></a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="st">                 FROM ecom </span></a>
<a class="sourceLine" id="cb93-3" data-line-number="3"><span class="st">                 WHERE device IS NULL&quot;</span>)</a></code></pre></div>
<pre><code>##  [1] id          referrer    device      bouncers    n_visit    
##  [6] n_pages     duration    country     purchase    order_items
## [11] order_value
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
<div id="like" class="section level2">
<h2><span class="header-section-number">4.12</span> LIKE</h2>
<p>The LIKE operator is used to search for a specific pattern in a column. There are two wildcards used in conjunction with the LIKE operator:</p>
<ul>
<li>% : represents zero, one, or multiple characters</li>
<li>_ : represents a single character</li>
</ul>
<p>In the following example, we filter all rows from the <code>ecom</code> table where the name of the <code>country</code> starts with <code>P</code>. We use <code>%</code> after <code>P</code> to indicate that it can be followed by any number or type of characters.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * </span></a>
<a class="sourceLine" id="cb95-2" data-line-number="2"><span class="st">                 FROM ecom </span></a>
<a class="sourceLine" id="cb95-3" data-line-number="3"><span class="st">                 WHERE country LIKE &#39;P%&#39;&quot;</span>)</a></code></pre></div>
<pre><code>##      id referrer device bouncers n_visit n_pages duration
## 1     5    yahoo mobile        1       9       1      955
## 2    14    yahoo tablet        0       5       8       80
## 3    17     bing tablet        0       5      16      368
## 4    43     bing laptop        1       0       1      456
##                   country purchase order_items order_value
## 1                  Poland        0           0           0
## 2             Philippines        0           2         362
## 3                    Peru        1           6        1049
## 4                Portugal        0           0           0
##  [ reached getOption(&quot;max.print&quot;) -- omitted 135 rows ]</code></pre>
<p>Let us look at another example where we filter all rows from the <code>ecom</code> table where the name of the
country should follow the below conditions:</p>
<ul>
<li>name can start with any character</li>
<li>the second character must be <code>o</code></li>
<li>it can have any type or number of characters after the second character</li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * </span></a>
<a class="sourceLine" id="cb97-2" data-line-number="2"><span class="st">                 FROM ecom </span></a>
<a class="sourceLine" id="cb97-3" data-line-number="3"><span class="st">                 WHERE country LIKE &#39;_o%&#39;&quot;</span>)</a></code></pre></div>
<pre><code>##      id referrer device bouncers n_visit n_pages duration
## 1     5    yahoo mobile        1       9       1      955
## 2     6    yahoo laptop        0       5       5      135
## 3    19   social tablet        0       7      10      290
## 4    30    yahoo mobile        0       8       9      225
##                    country purchase order_items order_value
## 1                   Poland        0           0           0
## 2             South Africa        0           0           0
## 3                 Colombia        1           9        1304
## 4                 Colombia        0           0           0
##  [ reached getOption(&quot;max.print&quot;) -- omitted 117 rows ]</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dbplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sql2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
